# project: mediasoft task

- [Описание проекта](#project)
- [Начало](#begin)
- [SELECT](#select)
- [ORDERBY](#orderby)
- [LIMIT](#limit)
- [INSERT](#insert)
- [WHERE](#where)
- [DELETE](#delete)
- [UPDATE](#update)




## Описание проекта
<a name="project"></a> 

При создании проекта использовались следующие инструменты:

1. **Query builder** - это инструмент, который позволяет значительно упростить работу с базой данных, для того, чтобы мы могли писать запросы к этой базе данных с помощью специального синтаксиса и не зависеть от какой-то конкретной базы данных.

2. **PostgreSQL** - это объектно-реляционная система управления базами данных, наиболее развитая из открытых СУБД в мире. Имеет открытый исходный код и является альтернативой коммерческим базам данных.

3. **PhpStorm** - коммерческая кросс-платформенная интегрированная среда разработки для PHP.

## Начало
<a name="begin"></a> 

Чтобы начать работу с базой данных в php, необходимо использовать **querybuilder**

```php
use DB\MyQueryBuilder;

require_once 'index.php';
```

и в переменную передать массив со следующим содержанием

```php
[

    'DB_DRIVER'       => 'pgsql', 

    'DB_HOST'       => '127.0.0.1', 

    'DB_PORT'       => порт бд, // указывается во время установки БД

    'DB_NAME'   => имя базы данных, 
    
    'DB_USER'   => имя пользователя, // указывается при создании сервера

    'DB_PASSWORD'   => пароль пользователя, // указывается во время установки БД
];
```
В качестве DB_DRIVER можно выбрать следующие бд: _pgsql ; mysql ; oci ; sqlite ; sybase ; mssql ; firebird_

Код для создания нового объекта для построения запросов

```php
$db = new MyQueryBuilder($config);
```

Для выполнения запроса и получения результатов, необходимо использовать следующую конструкцию

```php
$result = $db->execute();

dd($result);
```

## SELECT
<a name="select"></a> 

Чтобы получить все поля с таблицы, необходимо использовать следующую конструкцию

```php
$db->select()->from('table');
```

Для получения определенных полей в таблице

```php
$db->select(['fax', 'phone'])
```

Для полей с псевдонимами по типу (address as address_name)

```php
$db->select(['address_name' => 'shop.address', 'shop.id'])
```

## ORDERBY
<a name="orderby"></a> 

Для сортировки используется следующая конструкция

```php
$db
    ->select()
    ->from('cars')
    ->orderBy('name', 'DESC'); // 'ASC' по умолчанию
```

## LIMIT
<a name="limit"></a>

Также возможно ограничить показ строк в таблице следующим образом

```php
$db
    ->select()
    ->from('table')
    ->limit(3); // получить три записи начиная с нуля
```

также можно получить определенное количество записей начиная с определенной строки

```php
$db
    ->select()
    ->from('table')
    ->limit(3, 5); // получить три записи начиная с пяти
```

## INSERT
<a name="insert"></a>

благодаря insertInto в таблицу вводятся новые данные следующим образом

```php
    $db
    ->insertInto('shop', [
        'id' => '12',
        'address' =>'yrbets',
        'phone' => '88005553535',
        'fax' => '77777',
        ]);
```

## WHERE

Простой пример

```php
    $db->select()->from('shop')->where('id', '=', 4);
```

При каждой следующей созданной конструкции с помощью **WHERE** будет добавляться оператор AND. Чтобы добавить OR необходимо работать с методом **orWhere**

```php
    $db
    ->select()
    ->from('cars')
    ->where('speed', '>', 90)
    ->where('mass', '<', '80');
```

также можно и подобным образом

```php
    $db
    ->select()
    ->from('cars')
    ->where(['speed', '>', 90], ['mass', '<', '80', 'or']);
```

## DELETE
<a name="delete"></a>

```php
    $db
    ->delete()
    ->from('shop')
    ->where('id', '=', 4);
```

## UPDATE
<a name="update"></a>

```php
    $db
    ->update('shop',
        ['address' =>'laves',
         'phone' => '899954899879',
         'fax' => '7789779',
        ])
    ->where('shop.id', '=', 1);
```